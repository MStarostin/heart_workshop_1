# heart_workshop_1 - Предсказание рисков сердечного приступа


### Описание проекта
В проекте разработана модель для предсказания риска сердечного приступа, используя данные пациентов, такие как возраст, привычки, состояние здоровья и результаты анализа крови, а также реализовано приложение на FastAPI для получения предсказаний по пользовательскому запросу.

Общая информация и цель проекта:
* В проекте используется датасет из открытого источника.
* Разработана модель машинного обучения.
* Подготовлена библиотека и интерфейс для предсказания на тестовой выборке.

### Задачи проекта
В ходе работы над проектом решены следующие задачи:
* Исследование датасета, поиск дополнительной информации для лучшего понимания природы данных.
* Предобработка данных. В данных могут быть бесполезные признаки, сильно скорелированные признаки а также косвенные утечки целевого признака.
* Обучение моделией и выбор лучшей модели и ее параметров.
* Предсказания на тестовой выборке. Файл предсказаний в csv формате содержит 2 столбца: “id” и “prediction”. 
* Написан инструмента для тестирования на FastAPI.
* Оформлена документация.


### Описание исходных данных
Описание признаков для  модели

Демографические и социальные признаки
- Age (Возраст) — количество полных лет пациента
- Gender (Пол) — мужской/женский
- Income (Доход) — уровень финансового благосостояния
- id (Идентификатор) — уникальный номер записи

Антропометрические показатели
- BMI (Индекс массы тела) — соотношение веса и роста
- Obesity (Ожирение) — наличие/отсутствие ожирения
- Sedentary Hours Per Day (Часы малоподвижности в день) — время, проведенное в сидячем положении
- Sleep Hours Per Day (Часы сна в день) — продолжительность ночного сна

Физиологические показатели
- Cholesterol (Холестерин) — уровень холестерина в крови
- Triglycerides (Триглицериды) — уровень триглицеридов в крови
- Blood sugar (Уровень сахара) — концентрация глюкозы в крови
- Systolic blood pressure (Систолическое давление) — верхнее давление
- Diastolic blood pressure (Диастолическое давление) — нижнее давление
- Heart rate (Пульс) — частота сердечных сокращений
- CK-MB — маркер повреждения сердечной мышцы
- Troponin — белок, показатель повреждения миокарда

Образ жизни
- Smoking (Курение) — наличие/отсутствие привычки к курению
- Alcohol Consumption (Употребление алкоголя) — частота и количество употребления
- Exercise Hours Per Week (Часы физических упражнений в неделю)
- Physical Activity Days Per Week (Дни физической активности в неделю)
- Diet (Питание) — тип и качество питания
- Stress Level (Уровень стресса) — субъективная оценка стресса

Медицинские показатели и анамнез
- Diabetes (Диабет) — наличие/отсутствие диабета
- Family History (Семейный анамнез) — наличие сердечно-сосудистых заболеваний у родственников
- Previous Heart Problems (Предыдущие проблемы с сердцем) — наличие сердечно-сосудистых заболеваний в анамнезе
- Medication Use (Прием лекарств) — использование медикаментов
- Heart Attack Risk (Binary) (Риск инфаркта, бинарный) — целевая переменная, указывающая на риск инфаркта

Взаимосвязи признаков
- BMI тесно связан с Obesity
- Exercise Hours Per Week и Physical Activity Days Per Week связаны с Sedentary Hours Per Day
- Diet влияет на Cholesterol, Triglycerides и Blood sugar
- Stress Level может влиять на Heart rate и Blood pressure
- Medication Use часто связана с Diabetes, Previous Heart Problems

### Используемая метрика оценки качества и сравнения моделей
В ходе анализа выбрана метрика оценки качества модели, проведено сравнение моделей и выбрана лучшая

### Стек:
- Python
- Pandas
- numpy
- Scikitlearn
- CatBoost
- FastAPI
- HTML


### Инструкция по развертыванию приложения:

Приложение можно развернуть несколькими способами: в контейнере Docker или в виртуальном окружении.

#### Развертывание в контейнере Docker:
- для развертывания приложение в контейнере необходим установленный Docker и запущенный Docker демон.
- запустите терминал и перейдите в дирректорию в которой будет содержаться проект
- клонируйте репозиторий комайндой: `git cline https://github.com/MStarostin/heart_workshop_1.git`
- перейдите в дирректорию проекта: `cd heart_workshop_1`
- из дерриктори проекта создайте докер образ коммандой: `docker build -t heart .`
- запустите контейнер коммандой: `docker run -p 80:8000 --name heart-container  heart`
- обучите и сохраните модель коммандой: `docker exec -it heart-container python fit_save_model.py`
- откройте приложение в браузере по ссылке: http://localhost/
- документация к API: http://localhost/docs и http://localhost/redoc в формате ReDoc


#### Развертывание в виртуальном окружении:
- запустите терминал и перейдите в дирректорию в которой будет содержаться проект
- клонируйте репозиторий комайндой: `git cline https://github.com/MStarostin/heart_workshop_1.git`
- перейдите в дирректорию проекта: `cd heart_workshop_1`
- создайте виртуальное окружение коммандой: `python3 -m venv venv`
- активируйте виртуальное окружение коммандой: `source venv/bin/activate` для Linyx и MacOs и `source venv/scripts/activate` для Windows
- установите зависимости коммандой: `pip install -r requirements.txt`
- обучите и сохраните модель коммандой: `python fit_save_model.py`
- запустите приложение коммандой: `uvicorn app:app --reload`
- откройте приложение в браузере по ссылке: http://localhost:8000/
- документация к API: http://localhost:8000/docs и http://localhost/redoc в формате ReDoc


Приложение поучает на вход .csv файл с данными и возвращает предсказани я формате JSON

